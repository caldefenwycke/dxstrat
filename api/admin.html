<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarwinXPool Admin</title>
<style>
:root{--bg:#0b0f14;--card:#121922;--fg:#e6f0ff;--muted:#94a3b8;--green:#22c55e;--red:#ef4444;--blue:#3b82f6;}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font:14px/1.5 system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans}
header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:#0f172a;border-bottom:1px solid #1f2937}
h1{margin:0;font-size:18px;letter-spacing:.5px}
.container{max-width:1100px;margin:24px auto;padding:0 16px}
.card{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:16px;margin-bottom:16px;box-shadow:0 8px 24px rgba(0,0,0,.25)}
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.stat{padding:14px;border-radius:12px;background:#0f172a;border:1px solid #1f2937;text-align:center}
.stat .num{font-size:22px;font-weight:700}
.table{width:100%;border-collapse:collapse;margin-top:8px}
.table th,.table td{padding:8px 10px;border-bottom:1px solid #243041}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;background:#0b1220;border:1px solid #243041;color:#cbd5e1;font-size:12px}
a{color:var(--blue);text-decoration:none}
</style>
</head>
<body>
<header>
  <h1>DarwinXPool — Admin</h1>
  <div><span class="badge">API</span> <span class="badge">Stratum</span></div>
</header>
<div class="container">
  <div class="grid">
    <div class="stat"><div class="num" id="miners">—</div><div>Miners</div></div>
    <div class="stat"><div class="num" id="shares">—</div><div>Shares</div></div>
    <div class="stat"><div class="num" id="blocks">—</div><div>Blocks</div></div>
    <div class="stat"><div class="num" id="balance">—</div><div>Total Balance (sats)</div></div>
  </div>
  <div class="card">
    <h3 style="margin:0 0 8px;">Recent Miners</h3>
    <table class="table" id="minersTable">
      <thead><tr><th>ID</th><th>Address</th><th>Last Seen</th><th>Diff</th><th>Accepted</th><th>Rejected</th><th>Balance (sats)</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>
<script>
async function loadStats(){
  const s = await fetch('/stats').then(r=>r.json());
  document.getElementById('miners').textContent = s.miners;
  document.getElementById('shares').textContent = s.shares;
  document.getElementById('blocks').textContent = s.blocks;
  document.getElementById('balance').textContent = s.total_balance_sats;
  const m = await fetch('/miners').then(r=>r.json());
  const tbody = document.querySelector('#minersTable tbody'); tbody.innerHTML='';
  for (const r of m.miners){
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${r.id}</td><td>${r.address}</td><td>${new Date(r.last_seen_ts*1000).toLocaleString()}</td><td>${Math.round(r.difficulty)}</td><td>${r.total_accepted}</td><td>${r.total_rejected}</td><td>${r.balance_sats}</td>`;
    tbody.appendChild(tr);
  }
}
loadStats(); setInterval(loadStats, 5000);
</script>
</body>
</html>
